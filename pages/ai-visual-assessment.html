<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI视觉评估系统 - 农业机械贸易平台</title>
    <!-- 引入Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入Font Awesome -->
    <link href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入jsPDF用于生成PDF报告 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- 基础样式 -->
    <link rel="stylesheet" href="../css/style.css">
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-custom {
                transition: all 0.3s ease-in-out;
            }
        }
    </style>
    
    <style>
        /* 页面特定样式 */
        :root {
            --primary-color: #2E7D32;
            --accent-color: #D3AF58;
            --light-bg: #F8FAF8;
            --text-dark: #333333;
            --text-light: #666666;
            --border-radius: 10px;
            --box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            color: var(--text-dark);
            background-color: var(--light-bg);
        }
        
        /* 上传区域样式 */
        .upload-container {
            border: 2px dashed #ddd;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
            background: #fff;
            position: relative;
            overflow: hidden;
        }
        
        .upload-container:hover {
            border-color: var(--accent-color);
            box-shadow: 0 0 0 4px rgba(211, 175, 88, 0.1);
        }
        
        .upload-container.drag-over {
            border-color: var(--primary-color);
            background-color: rgba(46, 125, 50, 0.05);
            transform: scale(1.02);
            box-shadow: 0 0 0 4px rgba(46, 125, 50, 0.2);
        }
        
        .upload-container.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(46, 125, 50, 0.1);
        }
        
        .upload-icon {
            color: #ccc;
            transition: color 0.3s ease, transform 0.3s ease;
        }
        
        .upload-container:hover .upload-icon {
            color: var(--accent-color);
            transform: scale(1.1);
        }
        
        .upload-container.drag-over .upload-icon {
            color: var(--primary-color);
            transform: scale(1.2);
        }
        
        .upload-container.active .upload-icon {
            color: var(--primary-color);
        }
        
        .upload-title {
            color: var(--text-dark);
            font-size: 1.2rem;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .upload-container.drag-over .upload-title {
            color: var(--primary-color);
        }
        
        /* 进度条样式 */
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: #e0e0e0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            background: linear-gradient(90deg, var(--primary-color), #4CAF50);
            transition: width 0.6s ease-in-out;
            box-shadow: 0 0 10px rgba(46, 125, 50, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, 0.2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, 0.2) 50%,
                rgba(255, 255, 255, 0.2) 75%,
                transparent 75%,
                transparent
            );
            z-index: 1;
            background-size: 20px 20px;
            animation: move 1s linear infinite;
        }
        
        @keyframes move {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 20px 20px;
            }
        }
        
        /* 评分样式 */
        .rating-circle {
            position: relative;
            width: 180px;
            height: 180px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: conic-gradient(var(--primary-color) var(--rating-degrees), #f0f0f0 var(--rating-degrees));
            box-shadow: 0 0 20px rgba(46, 125, 50, 0.1);
        }
        
        .rating-circle::before {
            content: '';
            position: absolute;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: white;
        }
        
        .rating-value {
            position: relative;
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        /* 评估项目样式 */
        .assessment-item {
            border-bottom: 1px solid #eee;
            padding: 1rem 0;
        }
        
        .assessment-item:last-child {
            border-bottom: none;
        }
        
        /* 状态标签样式 */
        .status-badge {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            animation: pulse 1.5s ease-in-out;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* 加载动画 */
        .spinner {
            border: 4px solid rgba(46, 125, 50, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary-color);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 卡片动画 */
        .assessment-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.6s ease;
            opacity: 0;
            transform: translateY(30px);
        }
        
        .assessment-card.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .assessment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        /* 数字增长动画 */
        @keyframes countUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .item-score {
            animation: countUp 0.5s ease-out;
        }
        
        /* 分析步骤动画 */
        .step-item {
            opacity: 0.6;
            transition: all 0.3s ease;
        }
        
        .step-item.active {
            opacity: 1;
            transform: translateX(5px);
        }
        
        .step-item.completed .step-icon {
            border-color: var(--primary-color);
            background-color: var(--primary-color);
        }
        
        .step-item.completed .step-icon i {
            color: white;
        }
        
        /* 页面加载动画 */
        .page-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        
        .page-loader.hidden {
            opacity: 0;
            visibility: hidden;
        }
        
        .loader-container {
            text-align: center;
        }
        
        .loader-spinner {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        /* 图片预览网格 */
        .image-preview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .preview-image-container {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            animation: fadeInUp 0.5s ease;
            transform-origin: center;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .preview-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }
        
        .preview-image-container:hover .preview-image {
            transform: scale(1.1);
        }
        
        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255,0,0,0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            opacity: 0;
            transform: scale(0.8);
        }
        
        .preview-image-container:hover .remove-image {
            opacity: 1;
            transform: scale(1);
        }
        
        .remove-image:hover {
            background: rgba(255,0,0,0.9);
            transform: scale(1.1);
        }
        
        .preview-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            display: block;
        }
        
        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255,0,0,0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s ease;
        }
        
        .remove-image:hover {
            background: rgba(255,0,0,0.9);
        }
        
        /* 状态标签样式 */
        .status-badge {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .status-excellent { background: #4CAF50; color: white; }
        .status-good { background: #8BC34A; color: white; }
        .status-fair { background: #FFC107; color: white; }
        .status-poor { background: #FF9800; color: white; }
        .status-urgent { background: #F44336; color: white; }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .rating-circle {
                width: 150px;
                height: 150px;
            }
            
            .rating-circle::before {
                width: 125px;
                height: 125px;
            }
            
            .rating-value {
                font-size: 2rem;
            }
            
            .image-preview-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .preview-image {
                height: 100px;
            }
        }
        
        @media (max-width: 480px) {
            .upload-container {
                padding: 1.5rem;
            }
            
            .rating-circle {
                width: 120px;
                height: 120px;
            }
            
            .rating-circle::before {
                width: 100px;
                height: 100px;
            }
            
            .rating-value {
                font-size: 1.8rem;
            }
        }
        
        /* 加载动画 */
        .spinner {
            border: 4px solid rgba(46, 125, 50, 0.1);
            border-radius: 50%;
            border-top: 4px solid var(--primary-color);
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 卡片悬停效果 */
        .assessment-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .assessment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        /* 按钮样式 */
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }
        
        .btn-primary:hover::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary:hover {
            background-color: #1B5E20;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }
        
        .btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-accent {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-accent::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }
        
        .btn-accent:hover::after {
            width: 300px;
            height: 300px;
        }
        
        .btn-accent:hover {
            background-color: #B8860B;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(211, 175, 88, 0.3);
        }
        
        /* 语言选择器样式 */
        .language-container {
            margin-left: 1rem;
            display: flex;
            align-items: center;
        }
        
        .language-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem; /* 图标和文字之间的间距 */
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .language-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        /* 添加倒三角箭头 */
        .language-btn::after {
            content: "ⅴ";
            font-size: 0.8rem;
            margin-left: 0.3rem;
        }
        
        /* 确保图标和文字垂直居中 */
        .language-btn i {
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- 页面加载动画 -->
    <div class="page-loader" id="page-loader">
        <div class="loader-container">
            <div class="loader-spinner"></div>
            <p>正在加载AI视觉评估系统...</p>
        </div>
    </div>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <!-- Logo -->
                <div class="logo">
                    <a href="../index.html" class="flex items-center">
                        <img src="../images/logo.png" alt="磐工金田" class="mr-3">
                        <span style="font-size: 1.7rem; font-weight: bold;">磐工金田</span>
                    </a>
                </div>
                
                <!-- 移动端菜单按钮 -->
                <button class="menu-toggle" id="mobile-menu-button">
                    <i class="fa fa-bars"></i>
                </button>
                
                <!-- 导航菜单 -->
                <ul class="nav-menu">
                    <li><a href="../index.html">首页</a></li>
                    <li><a href="used-equipment.html">二手设备</a></li>
                    <li><a href="services.html">代办业务</a></li>
                    <li><a href="ai-services.html">AI智能服务</a></li>
                    <li><a href="ai-visual-assessment.html" class="active">AI视觉评估</a></li>
                    <li><a href="contact.html">联系我们</a></li>
                    
                    <!-- 登录注册按钮 - 调整为与导航栏一致的样式 -->
                    <li><a href="login.html">登录</a></li>
                    <li><a href="register.html">注册</a></li>
                </ul>
                
                <!-- 语言选择器 -->
                <div class="language-container">
                    <button class="language-btn" onclick="toggleLanguageMenu()">
                        <i class="fas fa-globe"></i> 中文
                    </button>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- 页面标题区域 -->
    <section class="page-header" style="background-color: #2E7D32; padding: 3rem 0;">
        <div class="container text-center">
            <h1 class="page-title" style="font-size: 2.5rem; color: white; margin: 0 0 1rem 0; font-weight: bold;">AI视觉评估系统</h1>
            <p class="page-subtitle" style="font-size: 1.2rem; color: white; margin: 0;">通过人工智能技术，快速准确评估农机设备状况</p>
        </div>
    </section>
    
    <!-- 主要内容区 -->
    <main class="main-content">
        <div class="container">
            <!-- 上传区域 -->
            <section class="upload-section" id="upload-section">
                <div class="card bg-white rounded-lg shadow-lg p-6 mb-8">
                    <h2 class="section-title text-center mb-6">上传农机设备图片</h2>
                    
                    <!-- 图片上传容器 -->
                        <div class="upload-container text-center py-10 px-4 mb-6" id="upload-container">
                            <div class="upload-icon mb-4">
                                <i class="fa fa-cloud-upload text-5xl"></i>
                            </div>
                            <h3 class="upload-title mb-2">拖放图片到此处，或点击上传</h3>
                            <p class="upload-subtitle text-text-light mb-4">支持JPG、PNG、WEBP格式，最大10MB/张，最多上传5张</p>
                            <label for="file-upload" class="btn-accent inline-block">
                                <i class="fa fa-picture-o mr-2"></i>选择图片
                                <input type="file" id="file-upload" accept="image/*" multiple hidden>
                            </label>
                        </div>
                    
                    <!-- 图片预览区域 -->
                    <div id="image-preview" class="image-preview-grid hidden"></div>
                    
                    <!-- 上传按钮 -->
                        <div class="text-center mt-6">
                            <button id="analyze-button" class="btn-primary" disabled>
                                <i class="fa fa-cogs mr-2"></i>开始分析
                            </button>
                        </div>
                </div>
            </section>
            
            <!-- 分析进度区域 -->
            <section class="progress-section hidden" id="progress-section">
                <div class="card bg-white rounded-lg shadow-lg p-6 mb-8">
                    <h2 class="section-title text-center mb-6">AI分析进行中</h2>
                    
                    <div class="progress-container max-w-2xl mx-auto">
                        <div class="progress-info flex justify-between mb-2">
                            <span id="progress-text">正在分析图片...</span>
                            <span id="progress-percentage">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                        </div>
                        
                        <!-- 分析步骤 -->
                        <div class="analysis-steps mt-8">
                            <div class="step-item flex items-center mb-4" id="step-image-processing">
                                <div class="step-icon mr-4 w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
                                    <i class="fa fa-picture-o text-gray-500"></i>
                                </div>
                                <div>
                                    <h4 class="step-title">图片处理</h4>
                                    <p class="step-description text-text-light">正在优化和预处理上传的图片</p>
                                </div>
                            </div>
                            
                            <div class="step-item flex items-center mb-4" id="step-feature-detection">
                                <div class="step-icon mr-4 w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
                                    <i class="fa fa-search text-gray-500"></i>
                                </div>
                                <div>
                                    <h4 class="step-title">特征识别</h4>
                                    <p class="step-description text-text-light">正在识别设备关键部件和特征</p>
                                </div>
                            </div>
                            
                            <div class="step-item flex items-center mb-4" id="step-condition-assessment">
                                <div class="step-icon mr-4 w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
                                    <i class="fa fa-check-square-o text-gray-500"></i>
                                </div>
                                <div>
                                    <h4 class="step-title">状况评估</h4>
                                    <p class="step-description text-text-light">正在评估设备各部分的磨损和损坏情况</p>
                                </div>
                            </div>
                            
                            <div class="step-item flex items-center" id="step-report-generation">
                                <div class="step-icon mr-4 w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center">
                                    <i class="fa fa-file-text-o text-gray-500"></i>
                                </div>
                                <div>
                                    <h4 class="step-title">报告生成</h4>
                                    <p class="step-description text-text-light">正在生成详细的评估报告</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 评估结果区域 -->
            <section class="results-section hidden" id="results-section">
                <!-- 总体评分卡片 -->
                <div class="card bg-white rounded-lg shadow-lg p-6 mb-8 assessment-card">
                    <h2 class="section-title text-center mb-6">总体评估结果</h2>
                    
                    <div class="overall-rating flex flex-col md:flex-row items-center justify-between">
                        <!-- 评分圆环 -->
                        <div class="rating-circle mb-6 md:mb-0" id="rating-circle" style="--rating-degrees: 288deg;">
                            <span class="rating-value">80</span>
                        </div>
                        
                        <!-- 评估信息 -->
                        <div class="rating-info w-full md:w-3/5">
                            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                                <h3 class="status-label text-xl font-semibold">设备状况等级：</h3>
                                <span class="status-badge status-good">良好</span>
                            </div>
                            
                            <div class="mb-4">
                                <h3 class="info-label text-xl font-semibold mb-2">市场估值范围：</h3>
                                <p class="info-value text-2xl font-bold text-primary-color">¥120,000 - ¥145,000</p>
                            </div>
                            
                            <div>
                                <h3 class="info-label text-xl font-semibold mb-2">评估时间：</h3>
                                <p class="info-value" id="assessment-time">2023年6月15日 14:30</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 详细评分项目 -->
                <div class="card bg-white rounded-lg shadow-lg p-6 mb-8 assessment-card">
                    <h2 class="section-title text-center mb-6">详细评分项目</h2>
                    
                    <div class="assessment-items">
                        <div class="assessment-item">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="item-title font-semibold">外观状况</h3>
                                <span class="item-score font-bold">85分</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 85%;"></div>
                            </div>
                            <p class="item-description text-text-light mt-1">轻微划痕，整体保养良好</p>
                        </div>
                        
                        <div class="assessment-item">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="item-title font-semibold">机械性能</h3>
                                <span class="item-score font-bold">78分</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 78%;"></div>
                            </div>
                            <p class="item-description text-text-light mt-1">发动机运行正常，传动系统有轻微磨损</p>
                        </div>
                        
                        <div class="assessment-item">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="item-title font-semibold">电气系统</h3>
                                <span class="item-score font-bold">82分</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 82%;"></div>
                            </div>
                            <p class="item-description text-text-light mt-1">部分线路老化，建议检查更换</p>
                        </div>
                        
                        <div class="assessment-item">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="item-title font-semibold">液压系统</h3>
                                <span class="item-score font-bold">75分</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 75%;"></div>
                            </div>
                            <p class="item-description text-text-light mt-1">有轻微泄漏现象，需要密封检查</p>
                        </div>
                        
                        <div class="assessment-item">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="item-title font-semibold">底盘系统</h3>
                                <span class="item-score font-bold">80分</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 80%;"></div>
                            </div>
                            <p class="item-description text-text-light mt-1">轮胎磨损均匀，悬挂系统状态良好</p>
                        </div>
                    </div>
                </div>
                
                <!-- 维修建议 -->
                <div class="card bg-white rounded-lg shadow-lg p-6 mb-8 assessment-card">
                    <h2 class="section-title text-center mb-6">维修建议</h2>
                    
                    <div class="maintenance-suggestions">
                        <div class="suggestion-item mb-4 p-4 bg-light-bg rounded-lg">
                            <div class="flex items-start">
                                <div class="suggestion-icon mr-4 mt-1">
                                    <i class="fa fa-wrench text-accent-color text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="suggestion-title font-semibold mb-1">短期维修（1个月内）</h3>
                                    <ul class="suggestion-list text-text-light list-disc pl-5">
                                        <li>检查并修复液压系统泄漏问题</li>
                                        <li>更换老化的电气线路</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="suggestion-item p-4 bg-light-bg rounded-lg">
                            <div class="flex items-start">
                                <div class="suggestion-icon mr-4 mt-1">
                                    <i class="fa fa-cogs text-accent-color text-xl"></i>
                                </div>
                                <div>
                                    <h3 class="suggestion-title font-semibold mb-1">长期维护（3-6个月内）</h3>
                                    <ul class="suggestion-list text-text-light list-disc pl-5">
                                        <li>对传动系统进行全面检查和保养</li>
                                        <li>更换空气滤清器和机油</li>
                                        <li>检查并调整制动系统</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 报告操作按钮 -->
                <div class="text-center mb-8">
                    <button id="generate-report-button" class="btn-accent mr-4 mb-4 md:mb-0">
                        <i class="fa fa-download mr-2"></i>生成评估报告
                    </button>
                    <button id="new-assessment-button" class="btn-primary">
                        <i class="fa fa-refresh mr-2"></i>重新评估
                    </button>
                </div>
            </section>
        </div>
    </main>
    
    <!-- 页脚 -->
    <footer class="footer" style="background-color: #2E7D32; color: white; padding: 2rem 0;">
        <div class="container">
            <div class="footer-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                <div class="footer-col">
                    <h3 style="margin-bottom: 1rem; font-size: 1.2rem; color: #D3AF58;">关于我们</h3>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="about.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">平台介绍</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="about.html#team" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">团队成员</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="about.html#history" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">发展历程</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="about.html#contact" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">联系方式</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3 style="margin-bottom: 1rem; font-size: 1.2rem; color: #D3AF58;">产品中心</h3>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="products.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">全部产品</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="products.html?category=tractor" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">拖拉机</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="products.html?category=harvester" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">收割机</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="products.html?category=seeder" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">播种机</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="used-equipment.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">二手设备</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3 style="margin-bottom: 1rem; font-size: 1.2rem; color: #D3AF58;">服务支持</h3>
                    <ul style="list-style: none;">
                        <li style="margin-bottom: 0.5rem;"><a href="services.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">服务项目</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="equipment-rental.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">设备租赁</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="ai-services.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">AI智能服务</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="ai-visual-assessment.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">AI视觉评估</a></li>
                        <li style="margin-bottom: 0.5rem;"><a href="contact.html" style="color: #eee; text-decoration: none; transition: color 0.3s ease;">技术支持</a></li>
                    </ul>
                </div>
                
                <div class="footer-col">
                    <h3 style="margin-bottom: 1rem; font-size: 1.2rem; color: #D3AF58;">关注我们</h3>
                    <div class="social-icons" style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                        <a href="#" class="social-icon" style="color: white;"><i class="fa fa-weixin text-2xl"></i></a>
                        <a href="#" class="social-icon" style="color: white;"><i class="fa fa-weibo text-2xl"></i></a>
                        <a href="#" class="social-icon" style="color: white;"><i class="fa fa-youtube-play text-2xl"></i></a>
                        <a href="#" class="social-icon" style="color: white;"><i class="fa fa-linkedin text-2xl"></i></a>
                    </div>
                    <div class="contact-info">
                        <p style="margin-bottom: 0.5rem;"><i class="fa fa-phone"></i> 400-888-8888</p>
                        <p style="margin-bottom: 0.5rem;"><i class="fa fa-envelope"></i> contact@nongji.com</p>
                        <p style="margin-bottom: 0.5rem;"><i class="fa fa-map-marker"></i> 北京市朝阳区农业科技园</p>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom" style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
                <p class="copyright" style="margin-bottom: 0.5rem;">© 2023 农业机械贸易平台 版权所有</p>
                <div class="footer-links" style="display: flex; justify-content: center; gap: 1rem;">
                    <a href="#" style="color: #eee; text-decoration: none;">隐私政策</a>
                    <a href="#" style="color: #eee; text-decoration: none;">使用条款</a>
                    <a href="#" style="color: #eee; text-decoration: none;">网站地图</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- 返回顶部按钮 -->
    <button id="back-to-top" class="back-to-top">
        <i class="fa fa-arrow-up"></i>
    </button>
    
    <!-- JavaScript -->
    <script>
        // 切换语言菜单显示/隐藏 - 全局函数
        function toggleLanguageMenu() {
            console.log('切换语言菜单');
            // 由于实际项目中没有实现语言切换功能，这里只输出日志
            // 在实际应用中，这里会显示/隐藏语言下拉菜单
            alert('语言切换功能将在后续版本中完善');
        }
        
        // 确保页面完全加载后再执行JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // 全局变量
                let uploadedFiles = [];
                
                // DOM 元素
                const uploadContainer = document.getElementById('upload-container');
                const fileUpload = document.getElementById('file-upload');
                const imagePreview = document.getElementById('image-preview');
                const analyzeButton = document.getElementById('analyze-button');
                const uploadSection = document.getElementById('upload-section');
                const progressSection = document.getElementById('progress-section');
                const resultsSection = document.getElementById('results-section');
                const progressFill = document.getElementById('progress-fill');
                const progressPercentage = document.getElementById('progress-percentage');
                const progressText = document.getElementById('progress-text');
                const generateReportButton = document.getElementById('generate-report-button');
                const newAssessmentButton = document.getElementById('new-assessment-button');
                const assessmentTime = document.getElementById('assessment-time');
                const ratingCircle = document.getElementById('rating-circle');
                const ratingValue = document.querySelector('.rating-value');
                
                // 步骤元素
                const stepImageProcessing = document.getElementById('step-image-processing');
                const stepFeatureDetection = document.getElementById('step-feature-detection');
                const stepConditionAssessment = document.getElementById('step-condition-assessment');
                const stepReportGeneration = document.getElementById('step-report-generation');
                
                // 检查必要元素是否存在
                function checkRequiredElements() {
                    const requiredElements = [
                        uploadContainer, fileUpload, imagePreview, analyzeButton,
                        uploadSection, progressSection, resultsSection, progressFill,
                        progressPercentage, progressText, generateReportButton, newAssessmentButton
                    ];
                    
                    // 检查每个元素并提供错误提示
                    for (const element of requiredElements) {
                        if (!element) {
                            console.warn('Warning: Some UI elements are missing. Some features may not work properly.');
                            return false;
                        }
                    }
                    
                    return true;
                }
                
                // 检查用户登录状态
                function checkLoginStatus() {
                    // 模拟登录状态检查
                    const isLoggedIn = false;
                    
                    if (!isLoggedIn) {
                        console.log('用户未登录状态');
                    }
                    
                    return { isLoggedIn: isLoggedIn };
                }
                

                
                // 初始化语言选择器
                function initLanguageSelector() {
                    const languageButton = document.getElementById('language-button');
                    const languageDropdown = document.getElementById('language-dropdown');
                    
                    if (languageButton && languageDropdown) {
                        languageButton.addEventListener('click', function() {
                            languageDropdown.classList.toggle('show');
                        });
                        
                        // 点击其他地方关闭下拉菜单
                        document.addEventListener('click', function(event) {
                            if (!languageButton.contains(event.target) && !languageDropdown.contains(event.target)) {
                                languageDropdown.classList.remove('show');
                            }
                        });
                        
                        // 语言切换
                        const languageLinks = document.querySelectorAll('.language-dropdown a');
                        languageLinks.forEach(link => {
                            link.addEventListener('click', function(e) {
                                e.preventDefault();
                                const lang = this.getAttribute('data-lang');
                                languageButton.innerHTML = `<i class="fa fa-globe"></i> ${this.textContent}`;
                                languageDropdown.classList.remove('show');
                                console.log('切换到语言：', lang);
                            });
                        });
                    }
                }
                
                // 初始化平滑滚动
                function initSmoothScroll() {
                    try {
                        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                            anchor.addEventListener('click', function(e) {
                                e.preventDefault();
                                const targetId = this.getAttribute('href');
                                if (targetId === '#') return;
                                
                                const targetElement = document.querySelector(targetId);
                                if (targetElement) {
                                    targetElement.scrollIntoView({
                                        behavior: 'smooth'
                                    });
                                }
                            });
                        });
                    } catch (error) {
                        console.error('平滑滚动初始化失败:', error);
                    }
                }
                
                // 返回顶部按钮逻辑
                function initBackToTopButton() {
                    const backToTopButton = document.getElementById('back-to-top');
                    
                    if (backToTopButton) {
                        window.addEventListener('scroll', function() {
                            if (window.pageYOffset > 300) {
                                backToTopButton.classList.add('show');
                            } else {
                                backToTopButton.classList.remove('show');
                            }
                        });
                        
                        backToTopButton.addEventListener('click', function() {
                            window.scrollTo({
                                top: 0,
                                behavior: 'smooth'
                            });
                        });
                    }
                }
                
                // 初始化图片上传功能
                function initImageUpload() {
                    // 添加拖放事件监听器
                    const uploadContainer = document.getElementById('upload-container');
                    const fileUpload = document.getElementById('file-upload');
                    
                    if (uploadContainer && fileUpload) {
                        // 拖拽悬停事件
                        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, preventDefaults, false);
                        });
                        
                        function preventDefaults(e) {
                            e.preventDefault();
                            e.stopPropagation();
                        }
                        
                        // 添加拖拽视觉反馈
                        ['dragenter', 'dragover'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, highlight, false);
                        });
                        
                        ['dragleave', 'drop'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, unhighlight, false);
                        });
                        
                        function highlight() {
                            uploadContainer.classList.add('drag-over');
                        }
                        
                        function unhighlight() {
                            uploadContainer.classList.remove('drag-over');
                        }
                        
                        // 处理拖放文件
                        uploadContainer.addEventListener('drop', handleDrop, false);
                        
                        function handleDrop(e) {
                            const dt = e.dataTransfer;
                            const files = dt.files;
                            
                            if (files.length) {
                                handleFiles(files);
                            }
                        }
                    }
                    try {
                        if (!uploadContainer || !fileUpload || !imagePreview || !analyzeButton) {
                            console.warn('必要的上传元素缺失，无法初始化上传功能');
                            return;
                        }
                        
                        // 点击上传
                        uploadContainer.addEventListener('click', function() {
                            fileUpload.click();
                        });
                        
                        // 拖拽上传事件处理
                        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, preventDefaults, false);
                        });
                        
                        function preventDefaults(e) {
                            e.preventDefault();
                            e.stopPropagation();
                        }
                        
                        // 拖拽状态样式切换
                        ['dragenter', 'dragover'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, highlight, false);
                        });
                        
                        ['dragleave', 'drop'].forEach(eventName => {
                            uploadContainer.addEventListener(eventName, unhighlight, false);
                        });
                        
                        function highlight() {
                            uploadContainer.classList.add('active');
                        }
                        
                        function unhighlight() {
                            uploadContainer.classList.remove('active');
                        }
                        
                        // 处理拖放文件
                        uploadContainer.addEventListener('drop', handleDrop, false);
                        
                        function handleDrop(e) {
                            const dt = e.dataTransfer;
                            const files = dt.files;
                            handleFiles(files);
                        }
                        
                        // 处理文件选择
                        fileUpload.addEventListener('change', function() {
                            handleFiles(this.files);
                        });
                        
                        // 处理上传的文件
                        function handleFiles(files) {
                            if (files.length === 0) return;
                            
                            // 检查文件数量限制
                            const remainingSlots = 5 - uploadedFiles.length;
                            if (remainingSlots <= 0) {
                                alert('最多只能上传5张图片');
                                return;
                            }
                            
                            const filesToAdd = Array.from(files).slice(0, remainingSlots);
                            
                            // 验证文件类型和大小
                            const validFiles = filesToAdd.filter(file => {
                                const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
                                const isValidType = validTypes.includes(file.type);
                                const isValidSize = file.size <= 10 * 1024 * 1024; // 10MB
                                
                                if (!isValidType) {
                                    alert('不支持的文件类型：' + file.name);
                                } else if (!isValidSize) {
                                    alert('文件大小超过限制（10MB）：' + file.name);
                                }
                                
                                return isValidType && isValidSize;
                            });
                            
                            // 添加有效文件
                            if (validFiles.length > 0) {
                                validFiles.forEach(file => {
                                    uploadedFiles.push(file);
                                    previewFile(file);
                                });
                                
                                // 显示预览区域
                                imagePreview.classList.remove('hidden');
                                
                                // 启用分析按钮
                                analyzeButton.disabled = false;
                            }
                        }
                        
                        // 预览文件
                        function previewFile(file) {
                            const reader = new FileReader();
                            
                            reader.onload = function(e) {
                                const previewContainer = document.createElement('div');
                                previewContainer.className = 'preview-image-container';
                                
                                const img = document.createElement('img');
                                img.src = e.target.result;
                                img.className = 'preview-image';
                                img.alt = '预览图片';
                                
                                const removeButton = document.createElement('button');
                                removeButton.className = 'remove-image';
                                removeButton.innerHTML = '<i class="fa fa-times"></i>';
                                removeButton.addEventListener('click', function() {
                                    // 从上传列表中移除
                                    const index = uploadedFiles.findIndex(f => f.name === file.name && f.size === file.size && f.lastModified === file.lastModified);
                                    if (index !== -1) {
                                        uploadedFiles.splice(index, 1);
                                    }
                                    
                                    // 从DOM中移除预览
                                    previewContainer.remove();
                                    
                                    // 如果没有图片了，隐藏预览区域并禁用分析按钮
                                    if (uploadedFiles.length === 0) {
                                        imagePreview.classList.add('hidden');
                                        analyzeButton.disabled = true;
                                    }
                                });
                                
                                previewContainer.appendChild(img);
                                previewContainer.appendChild(removeButton);
                                imagePreview.appendChild(previewContainer);
                            };
                            
                            reader.readAsDataURL(file);
                        }
                    } catch (error) {
                        console.error('图片上传功能初始化失败:', error);
                    }
                }
                // 初始化分析功能
                function initAnalysis() {
                    if (!analyzeButton || !uploadSection || !progressSection) {
                        console.warn('分析功能所需元素缺失');
                        return;
                    }
                    
                    analyzeButton.addEventListener('click', function() {
                        // 检查是否有上传的文件
                        if (uploadedFiles.length === 0) {
                            alert('请先上传农机设备图片');
                            return;
                        }
                        
                        // 隐藏上传区域，显示进度区域
                        uploadSection.classList.add('hidden');
                        progressSection.classList.remove('hidden');
                        
                        // 模拟分析进度
                        simulateAnalysis();
                    });
                }
                
                // 模拟分析进度
                function simulateAnalysis() {
                    if (!progressFill || !progressPercentage || !progressText || !resultsSection) {
                        console.error('分析进度所需元素缺失');
                        return;
                    }
                    
                    let progress = 0;
                    const steps = [
                        { progress: 25, text: '正在识别图片特征...', step: stepImageProcessing },
                        { progress: 50, text: '正在分析机械部件...', step: stepFeatureDetection },
                        { progress: 75, text: '正在评估设备状况...', step: stepConditionAssessment },
                        { progress: 100, text: '正在生成评估报告...', step: stepReportGeneration }
                    ];
                    
                    const interval = setInterval(() => {
                        progress += 1;
                        progressFill.style.width = progress + '%';
                        progressPercentage.textContent = progress + '%';
                        
                        // 更新当前步骤
                        for (let i = steps.length - 1; i >= 0; i--) {
                            if (progress >= steps[i].progress - 5) {
                                progressText.textContent = steps[i].text;
                                
                                // 激活当前步骤
                                for (let j = 0; j <= i; j++) {
                                    if (steps[j].step) {
                                        activateStep(steps[j].step);
                                    }
                                }
                                break;
                            }
                        }
                        
                        // 分析完成
                        if (progress >= 100) {
                            clearInterval(interval);
                            
                            // 延迟显示结果，让用户看到100%完成
                            setTimeout(() => {
                                // 隐藏进度区域，显示结果区域
                                progressSection.classList.add('hidden');
                                resultsSection.classList.remove('hidden');
                                
                                // 添加动画显示效果给结果区域的卡片
                                setTimeout(() => {
                                    const cards = document.querySelectorAll('.assessment-card');
                                    cards.forEach((card, index) => {
                                        setTimeout(() => {
                                            card.classList.add('visible');
                                        }, index * 200);
                                    });
                                }, 500);
                                
                                // 设置评估时间为当前时间
                                if (assessmentTime) {
                                    const now = new Date();
                                    const formattedDate = now.getFullYear() + '年' + 
                                                        (now.getMonth() + 1) + '月' + 
                                                        now.getDate() + '日 ' + 
                                                        now.getHours() + ':' + 
                                                        (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
                                    assessmentTime.textContent = formattedDate;
                                }
                                
                                // 模拟随机评分（70-90之间）
                                const randomScore = Math.floor(Math.random() * 21) + 70;
                                
                                if (ratingCircle) {
                                    const degrees = (randomScore / 100) * 360;
                                    ratingCircle.style.setProperty('--rating-degrees', degrees + 'deg');
                                }
                                
                                if (ratingValue) {
                                    ratingValue.textContent = randomScore;
                                }
                                
                                // 根据评分更新状态标签
                                updateStatusLabel(randomScore);
                                
                                // 更新详细评分
                                updateDetailedScores(randomScore);
                            }, 1000);
                        }
                    }, 50);
                }
                
                // 激活步骤
                function activateStep(stepElement) {
                    if (!stepElement) return;
                    
                    const icon = stepElement.querySelector('.step-icon');
                    const iconInner = stepElement.querySelector('.step-icon i');
                    
                    if (icon && iconInner) {
                        icon.classList.remove('bg-gray-200');
                        icon.classList.add('bg-primary-color');
                        
                        iconInner.classList.remove('text-gray-500');
                        iconInner.classList.add('text-white');
                    }
                }
                
                // 更新状态标签
                function updateStatusLabel(score) {
                    const statusBadge = document.querySelector('.status-badge');
                    if (!statusBadge) return;
                    
                    // 移除所有状态类
                    statusBadge.classList.remove('status-excellent', 'status-good', 'status-fair', 'status-poor', 'status-urgent');
                    
                    // 根据评分添加相应状态类
                    if (score >= 90) {
                        statusBadge.textContent = '优秀';
                        statusBadge.classList.add('status-excellent');
                    } else if (score >= 80) {
                        statusBadge.textContent = '良好';
                        statusBadge.classList.add('status-good');
                    } else if (score >= 70) {
                        statusBadge.textContent = '一般';
                        statusBadge.classList.add('status-fair');
                    } else if (score >= 60) {
                        statusBadge.textContent = '较差';
                        statusBadge.classList.add('status-poor');
                    } else {
                        statusBadge.textContent = '急需维修';
                        statusBadge.classList.add('status-urgent');
                    }
                }
                
                // 更新详细评分
                function updateDetailedScores(overallScore) {
                    const assessmentItems = document.querySelectorAll('.assessment-item');
                    if (!assessmentItems.length) return;
                    
                    // 定义各个评分项目及其与总体评分的偏差范围
                    const scoreItems = [
                        { name: '外观状况', minDiff: -5, maxDiff: 5 },
                        { name: '机械性能', minDiff: -8, maxDiff: 3 },
                        { name: '电气系统', minDiff: -6, maxDiff: 4 },
                        { name: '液压系统', minDiff: -10, maxDiff: 2 },
                        { name: '底盘系统', minDiff: -5, maxDiff: 5 }
                    ];
                    
                    assessmentItems.forEach((item, index) => {
                        if (index >= scoreItems.length) return;
                        
                        // 生成随机偏差
                        const itemInfo = scoreItems[index];
                        const diff = Math.floor(Math.random() * (itemInfo.maxDiff - itemInfo.minDiff + 1)) + itemInfo.minDiff;
                        let itemScore = overallScore + diff;
                        
                        // 确保分数在0-100之间
                        itemScore = Math.max(0, Math.min(100, itemScore));
                        
                        // 更新分数显示
                        const scoreElement = item.querySelector('.item-score');
                        const progressFill = item.querySelector('.progress-fill');
                        
                        if (scoreElement) scoreElement.textContent = itemScore + '分';
                        if (progressFill) progressFill.style.width = itemScore + '%';
                    });
                }
                
                // 初始化报告生成功能
                function initReportGeneration() {
                    if (!generateReportButton) {
                        console.warn('报告生成按钮缺失');
                        return;
                    }
                    
                    generateReportButton.addEventListener('click', function() {
                        // 模拟PDF生成
                        alert('正在生成PDF报告，请稍候...');
                        
                        // 模拟下载延迟
                        setTimeout(() => {
                            alert('PDF报告已生成，即将下载');
                            // 模拟下载链接
                            const downloadLink = document.createElement('a');
                            downloadLink.href = '#';
                            downloadLink.download = `农机评估报告_${new Date().toLocaleDateString()}.pdf`;
                            document.body.appendChild(downloadLink);
                            downloadLink.click();
                            document.body.removeChild(downloadLink);
                        }, 1500);
                    });
                }
                
                // 初始化重新评估功能
                function initNewAssessment() {
                    if (!newAssessmentButton || !imagePreview || !analyzeButton || !resultsSection || !uploadSection) {
                        console.warn('重新评估功能所需元素缺失');
                        return;
                    }
                    
                    newAssessmentButton.addEventListener('click', function() {
                        // 重置状态
                        uploadedFiles = [];
                        
                        // 清空预览区域
                        imagePreview.innerHTML = '';
                        imagePreview.classList.add('hidden');
                        
                        // 禁用分析按钮
                        analyzeButton.disabled = true;
                        
                        // 隐藏结果区域，显示上传区域
                        resultsSection.classList.add('hidden');
                        uploadSection.classList.remove('hidden');
                    });
                }
                
                // 初始化所有功能
                function initializeApp() {
                    try {
                        // 首先检查必要元素
                        if (!checkRequiredElements()) {
                            console.warn('部分功能可能无法正常使用');
                        }
                        
                        // 依次初始化各个功能模块
                        checkLoginStatus();
                        initLanguageSelector();
                        initSmoothScroll();
                        initBackToTopButton();
                        initImageUpload();
                        initAnalysis();
                        initReportGeneration();
                        initNewAssessment();
                        
                        console.log('AI视觉评估系统初始化完成');
                    } catch (error) {
                        console.error('应用初始化错误:', error);
                        alert('系统初始化时发生错误，部分功能可能无法正常使用');
                    }
                }
                
                // 启动应用
                initializeApp();
                
                // 页面加载完成后隐藏加载动画
                window.addEventListener('load', function() {
                    setTimeout(() => {
                        const pageLoader = document.getElementById('page-loader');
                        if (pageLoader) {
                            pageLoader.classList.add('hidden');
                        }
                    }, 800); // 800ms后隐藏加载动画，给用户足够的视觉反馈
                });
            } catch (error) {
                console.error('整体应用加载失败:', error);
                alert('系统加载时发生错误，请刷新页面重试');
            }
        });
    </script>
</body>
</html>